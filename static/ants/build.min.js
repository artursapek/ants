(function(){var q,j,r,h,k,p;j=!0;r=function(){return $.ajax({type:"GET",url:"/ants/update",dataType:"json",data:{group:"hearo"},success:function(b){var a,c,d,e,f;f=[];for(e in b)d=b[e],0===$("#"+e).length?(a=$(".alley#"+d.name),a=$('<div class="halo"><div class="ant"></div></div>').attr({id:e,percentage:d.percentage}).css({left:""+d.percentage+"%",top:a.css("top")}),c=a.clone(),$.each([a,c],function(){this.data("data",JSON.parse(d.data));this.data("timestamp",d.timestamp);this.data("event",d.name);
return this.popup()}),$(".field#day").append(a),$(".field#bottom").append(c),f.push(c.reposition())):f.push(void 0);return f}})};q=function(b,a){return 100*((a-b[0])/(b[1]-b[0]))};p=function(){var b;b=$("#focus");return $("#focus-field").css({left:b.css("left"),right:b.css("right")})};k=function(){var b,a,c,d,e,f,i;b=$("#focus");c=new Date;c=100*((3600*c.getHours()+60*c.getMinutes()+c.getSeconds())/86400);$("#future").css({left:c+"%"});a={25:"#6am",50:"#noon",75:"#6pm"};i=Object.keys(a);e=0;for(f=
i.length;e<f;e++)d=i[e],c>d&&$(a[d]).show();$(".field#bottom .halo").each(function(){return $(this).reposition()});j&&(a=100-h(b.css("right"))-h(b.css("left")),b.css({left:c-a+"%",right:100-c+"%"}),p());return r()};$(document).ready(function(){k();setInterval(k,5E3);return $("#focus, #resize-left, #resize-right").each(function(){return $(this).stretch()})});h=function(b){var a;a=parseFloat(b.match(/[\d\.]+/g));return"px"===b.match(/..$/g)[0]?100*(a/document.width):a};(function(b){b.fn.stretch=function(){var a,
c,d,e,f,i;e=b(this);a=b("#focus");d=b("#future");b("#resize-left");b("#resize-right");c=b("#focus-field");f=void 0;i=!1;b(document).mouseup(function(){i=!1;a.removeClass("hover");f=void 0;return c.hide()}).mousemove(function(c){var g,k,o,l,m,n;if(i)return n=!0,g=c.clientX-f,k=h(a.css("left")),o=h(a.css("right")),l=h(d.css("left")),g=100*(g/b("body").width()),m=e.attr("id"),void 0!==f&&("resize-left"===m?a.animate({left:"+="+g+"%"},0):"resize-right"===m?o-g>100-l||0>g?(a.animate({right:"-="+g+"%"},
0),j=!1):(a.animate({right:100-l+"%"},0),f=d.offset().left,n=!1,j=!0):"focus"===m&&(m=a.offset(),o-g>100-l||0>g?(a.animate({right:"-="+g+"%",left:"+="+g+"%"},0),j=!1):1<Math.abs(parseInt(m.left+a.width())-parseInt(d.offset().left))?(a.animate({right:100-l+"%",left:l-(100-k-o)+"%"},0),f=c.clientX,n=!1,j=!0):(j=!0,n=!1))),n&&(f=c.clientX,b(".field#bottom").find(".halo").each(function(){return b(this).reposition()})),p()});return e.mousedown(function(b){i=!0;a.addClass("hover");c.show();return b.stopPropagation()})};
b.fn.reposition=function(){var a,c,d,e;c=b(this);a=b("#focus");d=h(a.css("left"));e=100-h(a.css("right"));a=h(c.attr("percentage"));d=q([d,e],a);return c.css({left:d+"%"})};return b.fn.popup=function(){var a,c;c=b(this);a=b('<div class="popup"></div>');a.append(b('<div class="timestamp">'+c.data("event")+" - "+c.data("timestamp")+'</div><table class="data"></table>'));void 0!==c.data("data")&&b.each(c.data("data"),function(c,e){return a.find("table").append(b("<tr><td>"+c+"</td><td>"+e.toString()+
"</td></tr>"))});c.mouseover(function(){a.show();return c.css("z-index","2001")}).mouseout(function(){a.hide();return c.css("z-index","11")});return a.appendTo(c)}})(jQuery)}).call(this);
